11/4(금) - 성보야... 나도 엠티 가고싶었는데..


오늘 한거 : 애니메이션 돌려보기


코딩부터 나가시남? 
월드행렬 -> 지꺼랑 부모꺼랑 결합이 되어있는거

행렬을 저장해서 뿌리는 기능은 만들어놓지 않았다, 이제 고런 기능을 쪼꼼 필요로 하는데
한번 맛배기로 뭘 좀 해보시려는데, 글로벌 행렬이라는걸 하나 만든다
EvaluateGlobalTransForm(int?) -> 특정 시간대에 모든 행렬이 결합된 최종 행렬
이걸 지금 맷월드트랜스뽐에 넣으면 포탑이 똑바로 선다
저걸 프레임에서 매개변수 올리면서 돌리면 애니메이션 되는거? 
Fbx 타이머라는게 있다, FbxTime::SetGlobalTimeMode(FbxTime::eFrame30) -> 30프레임을 기준으로 뭔가 행렬을 계산해라라라는 명령
FbxTime::EMode 뭐시기 = FbxTime::GetGlobalTimeMode(); -> 타임모드라는것을 하나 지정을했다? 뭔지잘모르겠네
다 따라치다가는 여기가 비주얼 스튜디오가 되것어,, 그냥 나중에 복붙하는걸로 하고 항상 그랬듯이 뭘 하신건지만 대충 파악해두지머
ㅋㅋ 판단잘했네 몬가몬가 겁나등장하는중~

오 쩔어 포탑 튀어나왔어
버텍스 버퍼? 리스트? 에는 원래 로칼행렬만 곱해져잇어야칸다 아닌가? 저거 글로벌뭐시가 로칼도 포함인가?
버텍스버퍼를 프레임마다 들고있다 -> 이게 스프라이트지 뭐야, 근데 이건 좀 무식한 방법이다
버텍스 버퍼를 하나만 갖고 애니메이션 행렬을 달리해서 곱하면 된다....? 버텍스 버퍼를 계속 업데이트 한다는 얘기맞져?

최종 월드 행렬 = 자기 (애니메이션)행렬 * 부모 (애니메이션)행렬
모든 FbxObject(우리가만든거)에다가 스스로의 로칼? 행렬을 저장을 한다
그렇게 저장을 하면 부모의 로칼 행렬을 갖고올수 있다, 내꺼랑 부모꺼를 알 수 있음 (근데 로칼도 둘다곱해야함? 어.. 곱하는게맞긴하겠네)

애니메이션을 처리하는 방법은 사실 정해져 있다 (글로벌 트랜스폼 거시기 그거) 근데, 
Fbx는 행렬이 이것저것 많이 등장한다, 뭘 사용해야 하는지 헷갈릴 수 있다, 그래서 이것저것 해보시는?
행렬관계를 쪼꼼 이해할 필요성이 있다

와.. 부모 * T * R * S 긴 한데 중간에 뭐가 존나게껴있네  (피벗어쩌구, S역행렬막이런거)
디버그할때 숫자 뒤에 e머시기 붙어있는건 사실 0이다 
엥 몬가 어케했더니 정답이랑 거의 똑같은거 나왔는데 머지 모가바뀐거지 -> 아니 뭐임ㅋㅋ 좀 돌렸더니 다음껀 또 안맞네

1. 정점에 관련된 애니메이션인건지
2. 오브젝트에 관련된 애니메이션인건지
두가지를 분리해서 사용할 필요성이 있다, 요부분은 나중에 캐릭터 애니메이션 할때 또 보게 될 것

암튼 저 글로벌트랜스폼이랑 같은 값을 수제로 만들어내고싶었는데, 실패했다
아니 근데 로칼행렬이랑 기하행렬이랑 다른거임? 헷갈려죽겠네 

어.. 아까 했던 타이머 몬가몬가들을 로드애니메이션 함수에 따로 빼버림
그리고 거기서 0프레임~마지막프레임 까지의 행렬 정보들을 빼서 뭐시기에 저장을 해줌
AnimTrack이라고 구조체를 따로 만들어서 저장 ㄷㄷ ( 프레임, 행렬정보 일케 두개있음)
당연히 저거 벡터로 맹글어놓고 푸쉬백~
애니메이션 정보는 이게 제일 핵심적인거고 이게 기본이다
Fbx매트릭스를 T매트릭스로 바꿔서 저장하는걸로 바꿀것 -> 컨버트매트릭스라는 함수(새로만들거신가?) 이걸로 바꿔줄것
우리꺼(T매트릭스)는 float로 되어있다, Fbx는 double로 되어있다 -> 실수 16개를 바꿔치는 작업을 먼저 할것 (그냥 ConvertMatrix)
그리고 DxConvertMatrix에서 직접 넣어줄 것, y랑 z가 바뀌어야 한다 -> 2행, 3행도 바까주네 (근데 열우선이면 구조가 좀 더 다르지않음? 아닌가? 아님말고)
임포터의 기저에 따라서 저 변환 수식이 달라진다? 뎃... 

아직도 머나먼 길이 남아있다, 고마워, 쟈이로.. 정말로.. 정말로 실로 머나먼 길..
그래서 수제로 저거랑 똑같이 만드는건 포기에여? ㅋㅋ

아무튼 샘플? Frame에서? 렌더에서 그냥 직접 계산  
로더의 프레임 렌더는 이제 필요가 읎다, 지워삠
오 애니메이션 된당 신기 
이제부터 시작이야, 좋아할거 하나도 없어 -> 자 이제 시작이야 내꿈을 내꿈을위한여행피카츄
오브젝트 애니메이션은 대부분 일케하면 된다, 근데 캐릭터 애니메이션은 일케해도 안됨 좀 달라지는게 있다

로더가 아니라 오브젝트를 새로 만들어서? 넘겨주는 게 낫다? -> 이건 뭐 알아서하라고하시네

지금 문제점? 해야할거? 암튼 대충 그런거
1. 때에 따라서는 프레임과 프레임 사이도 보간을 해줘야 한다 -> 행렬을 분해해서 srt를 찾아내야한다
2. 애니메이션이 없어도 애니메이션 트랙은 있다, 값이 다 똑같을 뿐 -> 최적화를 해줄 수 있다

애니메 씬.. 대충 시작프레임 종료프레임 이런 정보갖고있는 구조체? 흠 

마야z업을 빼보고 한번 해보겠다, 축 시스템을? 함보겠다? (axisSystem)
빼니까 야랄남ㅋㅋ 디버깅으로 업벡터 프론트벡터 뭐시기 암튼 축 정보를 볼수잇음
지금 거리 기준은 m인데 cm로 바꾸면 100배 커진ㄷ 


아무튼 이제 1번(보간)을 해야 하는디, srt가 분리가 되어야칸다
그래서 저 애니메트랙 구조체에 벡터3 t랑 쿼터니언;; 추가;; 벡터3 스케일도 추가 (trs ㅇㅇ)
아무튼 결과행렬에서 부모 애니메행렬을 빼고(역행렬곱해서?) 나온 셀프 애니메 행렬을 분해해서 srt를 만들어야한다
-> 보간은 일단 담주에~

종속관계를 벗어던지는게 좋기는 하다 (실제 게임에서는 Fbx쓸일이없응꼐) -> 로더랑 렌더는 완전히 별개다
앞으로 TBASIS를 자주 쓰게 될 거니까, 지금까지 우리가 만들었던 수학 라이브러리들에 역으로 네임스페이스를 걸어삐라
그리고 TBASIS가 디폴트가 되도록,, 근데 저는 K_라서 자동..으로 안바뀌는데요;; 
아! 근데 난 그러면 굳이 옛날거에 네임스페이스 걸 필요가 없네 ㅋㅋ 

아무튼 그런 작업을 들어가니까 이야~ 바꿀게 한무더기네요~
