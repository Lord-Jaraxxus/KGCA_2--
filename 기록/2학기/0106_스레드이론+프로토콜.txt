1/6(금) - 음~ 좀 더 빨리 자야겠는걸?

책 보면서 이론 조금..

클로즈 소켓 했다고 바로 닫히는게 아니다, 핸드셰이킹을 한 다음에 닫힌다

우리가 썼던 Create쓰레드는 멀티쓰레드 환경에 좀 별로다 옛날거라서 
그래서 C++에서 새로만든 뉴버전 _beginthreadex로 바꿀거다

스레드 스케줄링, 스레드 컨텍스트
스레드 컨텍스트 : 스위칭이 될때 저장해두는 작업 상태에 관한 정보 

TLS (스레드 지역 저장소) -> 집중이안대서제대로못들엇음..  
스레드 동기화 -> 어마무시하게 중요하다, 위에 TLS랑 같이간다


아니 어제 비교적 일찍잤는데 왤케 졸려뒤질것같지 ㅋㅋ




아무튼 어제 하던 프로토콜을 서버코드에도 마저 적용시킬 예정

유저마다 버퍼를 별도로 넣었다, 
클라에선 4바이트 헤더를 다 받을때까지 루프돌렸는데 서버에선 그러지 않도록 
?클라처럼바뀐건가?아몰랑대충보면알겠지

구조체를 바이트 단위로 정렬해서 저장하는, 패킹 이라는 기능이 필요로 하다?
구조체에서 short int short 하면 242가 아니라 444 해서 붕뜨는게 생기는데 
이걸 패킹하면 242 8바이트로 이쁘게 만들수있다, 이거 예전에 좀 봣던거같기도한데 암튼
pragma pack 이걸쓰면된다~~ 


아무튼 쪼끔 더 다듬고? 게임에서 쓸수있는 기능을 넣을것?
아 닉네임 REQ=리퀘스트,요청 ACK=응답

패킷 헤더만 보내서 타입만으로 해?석 가능한게 많다
 
아무튼 닉네임 기능을 추가중.. 어우 짖ㅂ줒ㅇ안대 

CREATE_SUSPENDED 이걸로 스레드 일시정지를할수가잇다
ResumeThread로 다시 ㄱ 가능
저거두개써서 닉넴 입력 전까지는 샌드스레드가 안돌아서 채팅 못보내도록 해놧다

send가 한번에 되질 않는다, (지금은 되겠지만 뭐 나중에 커지면 안된다?는느낌이겠지?)
그래서 검사를 해서 다 보낼때까지 돌리거나 해야?할?


아무튼 오늘의 핵심 -> 채팅 '프로토콜'을 갖고 만들었다



다음시간부터 서버의 입출력 모델이라는 것을 도입해야할?것
그리고 스레드의 문제점을 보완하기 위해서 스레드 동기화
워크스레드? ㅁㄴㅇㄹ




엄... 선생님은 서버스레드에서 받을때 여러개 동시에 받을 수 있게 짜신 것 같은데

나는 그냥.. 하나 다 받고 다음거 가는식으로 할래..
뭔가 들어왔으면 한번에 다 들어왔겠지 라는 마인드