1/9(월) - ㅁㄴㅇㄻㄹㄴㅁ 월요일싫어

키미노이로와나니이로~


윈도우에다가 붙이는 작업... 을... 먼저 한다.... 세상에..
갑자기 존나 어지러운데

서버는 콘솔로 하는게 기본적임, 윈도우 띄우는것도 자원을 소비하니까
서버는 로그를 반드시 남겨야한다

아무튼 지금은 DX기반이기 때문에 UI부분을 직접 만들어야 한다 -> 작업할게 상당히 많다, 야호.
아 DXㄹㅇ 다까먹었는데 조졌네 ㅋ ㅋㅋ ㅋㅋㅋ

UI에서 제일 힘든게 에디터, 에디터 기능이 제일 힘들다

윈도우에는 채팅에 관련된 기본 기능들이 쪼꼼 붙어있기때문에 지금은 그걸 쓰겠다 (DX에서 할라면 며칠 걸리기 때문에)
그래서 지금까지 써오던 샘플에서 DX기반을 싹 빼버리겠다.. 
샘플 런에다가 윈도우 런만 복붙해주고 윈도우만 돌게끔
메세지 프로시저에 있는 내용도 샘플로 빼삔다 (샘플에서 재정의해서)

윈도우 API를 이용해서 채팅 시스템을 만들어볼것
에디터라고 하는 미리 만들어져 있는 클래스 윈도우를 사용할 것 
저게다뭐람~~내오랜경험상굳이저걸다메모하기보다는걍복붙해서만드는게낫다는결론에도달
아무튼 에디터라고 하는 컨트롤 윈도우를 만들어놨따
버튼이랑 리스트박스도 하나씩 붙여주고~

지금은 미리 만들어져 있는걸 쓰지만 UI툴하는놈(나)들은 저걸 직접 만들어야 할것.. 줴에ㅔ에엥ㄴ장

버튼 이벤트를 달꺼임, case WM_COMMAND 해서 누르면 몬가되게끔
Print라는 함수를 하나 만들었는디, 나열형 연산자? 난생처음보는디;;;;;;; 
암튼 패킷을 받으면 패킷 안에 있는 메세지를 출력을 하것다
..가 아니라 이거 그 뭐냐 대충 리스트박스에 메세지 넣어주는 printf같은거네 


이제 대충 윈도우 모냥은 갖췄으니까 여따가 네트워크 기능을 구현할꺼임
라이브러리를 교체를 해야한다? windows.h랑 winsock2.h랑 충돌이 좀 나나?
순서가 중요하다, 윈솤2가 위로 올라가야 하니까 윈솤2헤더를 위로올려놓음 (라이브러리 밖에서 붙이면 나중에 붙어버려서)

TNet이라는 클래스를 만들어서 거기서 우리가 전에 했던 윈솤 채팅작업들을 갖다붙임
와... 오랜만이다 이 느낌.. 그리고 못따라가는 이느낌도..
지금 만든 이건 클라인가 서버인가.... 클라인갑네

윈도우 기반에서는 논블로킹으로 바꿔주는게 먼저다, 사실 윈도우 기반 소켓이 따로 있긴한데 암튼머

패킷 처리하는 부분을 렌더함수에서 처리하도록 빼놓음
몬가.. 문자열 처리에서 어지러워질듯한기분이좀드는데
맞네 ㅋㅋ %s가 지금 문제임, 그래서 멀티바이트로 날라온걸 유니코드로 바꿔서 출력을 하겠다 

클라에서 원래 센드쓰레드였는데, 이제 그런건 윈도우가 해주니까
오히려 리씨브 쓰레드로 바꾸는게 적절할것이다 (근데 블로킹으로)
-> 근데 이것도 사실 클라에 부담이 되니까, 다른식으로 짜야할것

넷프로세스라고 하나 새로 만들고 그게 샘플 프레임에서 돌도록?


이제 문서 잠깐~ 
서버가 리시브 쪼꼼씩쪼꼼씩 받아오면 느려터지니까 리시브 버퍼에 있는거 죄다 갖고와서
패킷 풀 <- 여따가 패킷단위로 짤라서 저장해서 처리해야 할 것 

스레드가 없어도 다수의 유저를 수용할 수 있는 시스템이 제공이 됩니다?
-> SELECT라고 하는 입출력 모델

셀렉트 모델을 쓰면 블로킹 논블로킹 상관없이 여러 소켓을 하나의 스레드로 처리할 수 있다
소켓이 배열로 들어가있어야 한다,
네트워크 이벤트가 발생을 하면 반환?

근데 한계가 있다, 그래서 그 한계가 뭐죠; -> 배열을 넘겨줘야만 한다, 64개의 소켓만 세팅가능 

지우고 세팅하고 셀렉트하고 확인하고를 매 프레임마다?  

업세트 리시브 센드를 로직을 돌리지 않고 이벤트에 의해서 처리할 수 있다... ? ?? ?? ?

AsyncSelect - 비동기 셀렉트 (윈도우에서만 사용가능)
-> 네트워크 이벤트가 발생하면 윈도우 메세지를 보낼 수 있음 
윈도우 시스템의 메세지 프로세싱을 네트워크에서 사용하겠다 라는 뜻

이벤트 셀렉트라는 게 있다 
이것도 윈도우 이벤트와 네트워크를 결합한 시스템



지금은 클라에서 스레드를 쓰고있는데, 이제 안쓰는 버전으로 바꿔볼꺼임
근데그건내일부터하시는게좋지않을까라고생각합니다선생님템포가좀애매해지잖아요심지어그냥셀렉트도아니고에이싱크셀렉트로하신다네세상에나마상에나대마상시합

사용자 정의 메세지를 만들어야한다,, 
사용자 메세지는 규칙이 있따, WM_USER+(아무숫자) 해줘야한다

오.. WSAGETSELECTEVENT라는 매크로 함수가 있따 우와~
이제 메세지 받고나서 CONNECT인지 READ인지 뭐시기인지 알아내서 이챠이챠 할수있다 

WRITE 메시지 -> 써도 된다는 뜻, 서버가 send를 받을 준비가 되었다




음.. 오늘 굉장히.. 어지럽긴 한데...

결론 : 1. 지금까지 했던 걸 윈도우 기반으로 돌려봄 -> 이건 오늘 다 해라!
        2. 그리고 에이싱크셀렉트 기반으로 쪼금 바꿔봄 -> 이건 아직 미완, 아마 내일 마저