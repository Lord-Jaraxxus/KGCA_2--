1/19 - ㅁㄴㅇㄹ.. 어우 발시려


지난시간에 완성을 못한 IOCP 소켓 서버 마저 하면서 시작합니다

음~ 닉네임 가져올때 몬가 닉네임 뒤에 쓰레기값이 붙는 사소한 이슈가 있었어요~ (서버.cpp의 서버쓰레드 case PACKET_NAME_REQ: 파트)
그래서 strlen(packet.msg) 이거 아니라 packet->ph.len - 패킷헤더사이즈(4) 로 바꿈

닉네임까지는 돌아가는데 그 이후가 안돌아가고있어요~
아 그거였구나 리시브를 또 받아야하는데 안걸어놓은거ㅎ 내가 찾았었던건데 몬가 뿌듯하네
암튼 그건 그거고 Send도 해줘야안하겠습니까 -> ㅇㅇ 

세션 매니저에 SendProcess?를? 추가? -> 유저리스트돌면서브로드캐스트패킷보내는거
근데그거서버cpp에서하는거아녔나->받는부분은서버cpp에서한게맞네,근데그럼보내는부분도서버cpp에서해주는게맞지않ㅏㄴ??
아니면받는것도매니저에서해주는게?? 흠

루틴 돌면서 지우는 건 별로 좋지가 않다, bool 디스커넥트 변수만 true로 해놓고 나중에 지우는게 낫다

(IOCP 안에서 WorkProc파트)
어.. 클라 강종할때 에러가 좀 달?라졌다, NETNAMEDELETED인가암튼그럼 
아무튼 에러체크 파트도 좀 손봐주고 

어... 아무튼 이렇게 기존에 있던 서버를 IOCP기반으로 바꿔는 봤따
근데그뭐냐 디스패치Send는? 안써요 저거?


일단 기본은 여기까진데, 서버는 안정화? 최적화? 이런 작업을 계속 해야한다
배열의 한계? -> 여유 메모리가 넘 많을수도 잇음
를 리스트를 써서 극복 -> 근데 이러면 또 귀찮은게 있고 아무튼 몬가몬가
배열이 오히려 최적화? (용량이 거의 정해져있는 경우에는) 


IOCP를 할때 신경써야하는거 
1. 지난시간에했던그거(패킷을뭉탱이로받는거)
2. 패킷이여기저기왔다갔다하면서복사가오지게되는데, 복사횟수를줄이는거
3. 오버랩 구조체

지금은 Recv버퍼 -> Data버퍼 -> 센드패킷리스트 -> 브로드패킷리스트 막 이카고있는데
Recv버퍼 -> Data버퍼 파트 정도는 줄여줘도 된다, Data버퍼로 바로 받도록 
-> 바로 해버리심ㅋ

오버랩 구조체 -> 비동기 작업의 갯수만큼 있어야함 (한 비동기 작업에 쓰고있는 오버랩 구조체는 다른 비동기 작업에 쓸 수 없다)
오버랩구조체 두개이상필요할지도? 
Recv는 하나면 되는데, Send는 한번에 뭐 여러번 보낼수도 있?다
근데 이것도 Send 비동기 끝나고 받아오면 안됨? 그럼 너무 느려지나?
어.. 오버랩 구조체를? 전역화를 해야한다? -> 메모리 풀? 오브젝트 풀? 이라는 개념?

아니 풀이 아니라 툴이었어? 아무튼 ClassTool이라고 클래스 하나 만들고 시작 -> Pool 맞구요 ㅋㅋ 
큐..를 shared_ptr <-이거뭐더라 ㅅㅂ 그거 그건가 그 그거 딜리트 안해도되는 스마트포인터 그래 그거 
ㅋ ㅋㅋ ㅋㅋㅋ ㅋ ㅋ ㅋ ㅋ ㅋ   무엇을 위해 무엇을 만들고계신건지 모르겠다 야호
Chunk는또뭔뜻이여~
복사연산자랑 대입연산자를 private에 넣어서 막아버림 -> 우회경로로 쓰지 못하게끔


잤어..


풀 하던거 쪽인 것 같은데 통,, 모르겟ㄷ다,,
원형 큐? 원형 배열? 머리 꼬리?
인터락 함수? 저건 또 뭐야 ㅋㅋ 돌겠네 진짜 

영 엉뚱한 구석에서 막혀버렸네... 음.... 음~

아니 진짜 저게 뭐하는건지 모르겠네 ㅋㅋ
한번 new해놓은 포인터들을 재활용하려고 하는건가? -> 맞는?듯?

아무튼 헤드랑 테일포스가 롱롱인 이유를 알면 로직을 이해한 것 
왜 롱롱이느느냐 -> 얘들은 증가만 함, 빼는 게 없음

대충 미리 ov들 new 해놓고 비동기 작업 하려고 할때마다 빌려주고 
반납할때는 제자리에 반납하고 그런 느낌.. 음..

오버랩 구조체는 풀 느낌으로 해야한다
유저마다 리스트로 들고 재활용을 해도 되고? 






----------
그래서 오늘 뭐하냐... 
킹만의 코드를 포기하니까 뭐 하기도 싫고 보기도 싫고 아무것도 하기싫네
걍 언리얼이나 좀 볼까 

ㅋㅋ 내 클라 결국 ph.len에 헤더 길이도 더하는걸로 굴복했음
아니 그래서 왜 패킷 두번 보냄? 폭풍은 언제나 두 번 친다 그런거임? -> 머 선생님도 그랬응께 나중에 고치시것지..

오늘 핵심은 뭐 결국 오브젝트 풀 <- 이거인 것 같은데
아몰랑ㅋㅋ 있는거 주워다쓸랭